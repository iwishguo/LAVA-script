metadata:
    name: linaro-edk2-build
    format: "Lava-Test-Shell Test Definition 1.0"
    description: "Pure build test for Linaro edk2"
    maintainer:
        - heyi.guo@linaro.org
    os:
        - Debian
    scope:
        - functional
    devices:
        - kvm
        - x86
params:
    GCC_REV: gcc-linaro-4.9-2014.11-x86_64_aarch64-linux-gnu
install:
    steps:
        - df -h
        - apt-get clean
        - df -h
        - cd ${HOME}
        - pwd
        - wget http://releases.linaro.org/14.11/components/toolchain/binaries/aarch64-linux-gnu/${GCC_REV}.tar.xz
        - tar -xvJf ${GCC_REV}.tar.xz
        - rm ${GCC_REV}.tar.xz
        - export PATH=$PATH:`pwd`/${GCC_REV}/bin
        - git clone http://git.linaro.org/uefi/linaro-edk2.git
        - git clone http://git.linaro.org/uefi/linaro-edk2-tools.git uefi-tools
        - ls

    deps:
        - build-essential
        - python
        - git-core
 
run:
    steps:
       - cd ${HOME}/linaro-edk2
       - pwd
       - ls
       - lava-test-case juno-debug --shell ../uefi-tools/uefi-build.sh -b DEBUG juno
       - lava-test-case juno-debug --shell ../uefi-tools/uefi-build.sh -b DEBUG juno
       - lava-test-case juno-debug-clean --shell ../uefi-tools/uefi-build.sh -b DEBUG juno cleanall
       - lava-test-case juno-release --shell ../uefi-tools/uefi-build.sh -b RELEASE juno
       - lava-test-case juno-release-clean --shell ../uefi-tools/uefi-build.sh -b RELEASE juno cleanall

